<!-- crear_cuenta.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Crear Cuenta</title>
</head>
<body>
  <h2>Crear Cuenta Chileno</h2>
  <form id="crear">
    <input type="text" placeholder="RUN" id="run" required>
    <input type="text" placeholder="Nombre" id="nombre" required>
    <input type="text" placeholder="Apellido" id="apellido" required>
    <select id="sexo" required>
      <option value="" disabled selected>Selecciona sexo</option>
      <option value="F">Femenino</option>
      <option value="M">Masculino</option>
      <option value="O">Otro</option>
    </select>
    <input type="tel" placeholder="Telefono" id="telefono" required>
    <input type="password" placeholder="Contraseña" id="contrasena" required>
    <button type="submit">Crear Cuenta</button>
  </form>
  <p>¿Ya tienes cuenta? <a href="iniciosesion.html">Iniciar sesión</a></p>
  <button onclick="window.history.back()">Volver Atrás</button>

  <script>
    document.getElementById('crear').addEventListener('submit', async function(e) {
      e.preventDefault();
      const run = document.getElementById('run').value;
      const nombre = document.getElementById('nombre').value;
      const apellido = document.getElementById('apellido').value;
      const sexo = document.getElementById('sexo').value;
      const telefono = document.getElementById('telefono').value;
      const contrasena = document.getElementById('contrasena').value;

      const response = await fetch('http://localhost:8080/usuario/crear', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ run, nombre, apellido, sexo, telefono, contrasena })
      });

      if (response.ok) {
        const usuario = await response.json();
        localStorage.setItem('usuario', JSON.stringify(usuario));
        alert('Cuenta creada correctamente');
        window.location.href = 'opciones.html';
      } else {
        alert('Error al crear la cuenta');
      }
    });
  </script>
</body>
</html>